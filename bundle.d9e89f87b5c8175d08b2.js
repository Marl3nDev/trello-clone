(()=>{"use strict";var e="trello-clone",t={todo:[],"in-progress":[],done:[]},n=null,o=null,a=0,c=0,i=null;function l(){localStorage.setItem(e,JSON.stringify(t))}function d(){Object.keys(t).forEach(function(e){var n=document.querySelector('.cards[data-column="'.concat(e,'"]'));n.innerHTML="",t[e].forEach(function(o,a){var c=function(e,n,o){var a=document.createElement("div");a.className="card",a.dataset.id=e.id,a.dataset.column=n,a.dataset.index=o,a.textContent=e.text;var c=document.createElement("span");return c.className="delete-card",c.textContent="âœ•",c.onclick=function(o){o.stopPropagation(),t[n]=t[n].filter(function(t){return t.id!==e.id}),l(),d()},a.append(c),a.addEventListener("mousedown",function(e){e.target.closest(".delete-card")||r.call(a,e)}),a}(o,e,a);n.append(c)})})}function r(e){n=this,document.body.classList.add("dragging");var t=this.getBoundingClientRect();a=e.clientX-t.left,c=e.clientY-t.top,(o=this.cloneNode(!0)).classList.add("ghost"),o.style.width="".concat(t.width,"px"),o.style.height="".concat(t.height,"px"),o.style.left="".concat(t.left,"px"),o.style.top="".concat(t.top,"px"),document.body.append(o),this.style.visibility="hidden",document.addEventListener("mousemove",s),document.addEventListener("mouseup",u)}function s(e){o.style.left="".concat(e.pageX-a,"px"),o.style.top="".concat(e.pageY-c,"px");var t=document.elementFromPoint(e.clientX,e.clientY),n=null==t?void 0:t.closest(".card"),i=null==t?void 0:t.closest(".cards");if(f(),n){var l=n.getBoundingClientRect();m(n,e.clientY<l.top+l.height/2?"before":"after")}else i&&m(i,"inside")}function u(e){if(document.body.classList.remove("dragging"),o.remove(),n.style.visibility="visible",i){var a=i.dataset,c=a.toColumn,r=a.toIndex;m=n.dataset.id,p=n.dataset.column,v=c,y=Number(r),g=t[p].find(function(e){return e.id===m}),t[p]=t[p].filter(function(e){return e.id!==m}),t[v].splice(y,0,g),l(),d()}var m,p,v,y,g;f(),n=null,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",u)}function m(e,o){var a,c,l=document.createElement("div");l.className="drop-zone",l.style.height="".concat(n.offsetHeight,"px"),"inside"===o?(a=e.dataset.column,c=t[a].length,e.append(l)):(a=e.dataset.column,c=Number(e.dataset.index)+("after"===o?1:0),"after"===o?e.after(l):e.before(l)),l.dataset.toColumn=a,l.dataset.toIndex=c,i=l}function f(){i&&(i.remove(),i=null)}document.addEventListener("DOMContentLoaded",function(){t=function(){try{var t=localStorage.getItem(e);if(t){var n=JSON.parse(t);return{todo:n.todo||[],"in-progress":n["in-progress"]||[],done:n.done||[]}}}catch(e){}return{todo:[],"in-progress":[],done:[]}}(),d(),document.querySelectorAll(".add-card-form").forEach(function(e){var n=e.querySelector("textarea"),o=e.previousElementSibling;e.onsubmit=function(a){var c,i;a.preventDefault(),n.value.trim()&&(c=n.value.trim(),i=e.closest(".column").dataset.column,t[i].push({id:"card-"+Date.now(),text:c}),l(),d(),n.value="",e.style.display="none",o.style.display="block")}}),document.querySelectorAll(".add-card-btn").forEach(function(e){e.onclick=function(){e.style.display="none",e.nextElementSibling.style.display="block",e.nextElementSibling.querySelector("textarea").focus()}}),document.querySelectorAll(".cancel-card-add").forEach(function(e){e.onclick=function(){var t=e.closest(".add-card-form");t.style.display="none",t.previousElementSibling.style.display="block"}})})})();